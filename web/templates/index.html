{{define "body"}}
<div class="parent">
  <aside class="aside-container">
    <h1 class="aside__title">The Great Divide Mountain Bike Route </h1>
    <article class="aside__text mb-20">
      <p>For the next 30 days my friend Pat and I will be riding our bicycles from North to South.</p>
      <p>You can see the planned route in blue and the completed part in orange on the map. I am carrying a GPS tracker
        that will update the map with my live location and all other stats every 10 minutes. This GPS tracker can also
        send and receive messages, further down is a way of sending me messages either through space via satellites
        directly to the tracker or just simply through copper and fiber optic to this website.</p>
    </article>
    <section class="aside__route mb-20">
      <h2>Planned Route</h2>
      <article class="block col-2">
        <section class="row">
          <div class="col">Sep 9th<small class="label">Start Date</small></div>
          <div class="col">Oct 9th<small class="label">End Date</small></div>
        </section>
        <section class="row">
          <div class="col">3,891 km<small class="label">Distance</small></div>
          <div class="col">30 days<small class="label">Estimated Duration</small></div>
        </section>
        <section class="row">
          <div class="col">44,009 m<small class="label">Elevation Gain</small></div>
          <div class="col">43,413 m<small class="label">Elevation Loss</small></div>
        </section>
        <section class="row">
          <div class="col">13.8 %<small class="label">Max Grade</small></div>
          <div class="col">-27.4 %<small class="label">Min Grade</small></div>
        </section>
        <section class="row">
          <div class="col">39 %<small class="label">Paved</small></div>
          <div class="col">61 %<small class="label">Unpaved</small></div>
        </section>
      </article>
    </section>
    <section class="aside__ride mb-20">
      <h2>Actual Ride</h2>
      <article class="block col-2">
        <section class="row">
          <div class="col">
            <div id="isMoving"></div><small class="label">Currently Moving</small>
          </div>
          <div class="col">
            <div id="lastPing"></div><small class="label">Last Signal</small>
          </div>
        </section>
        <section class="row">
          <div class="col">
            {{ if .Ride.Distance }}
            {{ oneDecimal (inKm .Ride.Distance) }} km
            {{ else }}
            N/A
            {{ end }}
            <small class="label">Distance</small>
          </div>
          <div class="col">
            {{ if .Ride.Progress }}
            {{ .Ride.Progress }} %
            {{ else }}
            N/A
            {{ end }}
            <small class="label">Progress</small>
          </div>
        </section>
        <section class="row">
          <div class="col">
            {{ if .Ride.ElevationGain }}
            {{ .Ride.ElevationGain }} m
            {{ else }}
            N/A
            {{ end }}
            <small class="label">Elevation Gain</small>
          </div>
          <div class="col">
            {{ if .Ride.ElevationLoss }}
            {{ .Ride.ElevationLoss }} m
            {{ else }}
            N/A
            {{ end }}
            <small class="label">Elevation Loss</small>
          </div>
        </section>
        <section class="row">
          <div class="col">
            {{ if .LastEvent.Speed }}
            {{ oneDecimal .LastEvent.Speed }} km/h
            {{ else }}
            N/A
            {{ end }}
            <small class="label">Current Speed</small>
          </div>
          <div class="col">{{ oneDecimal .LastEvent.Altitude }} m<small class="label">Current Elevation</small></div>
        </section>
        <section class="row">
          <div class="col">
            {{ if .Ride.MovingTime }}
            {{ time .Ride.MovingTime }}
            {{ else }}
            N/A
            {{ end }}
            <small class="label">Moving Time</small>
          </div>
          <div class="col">
            {{ if .Ride.RestingTime }}
            {{ time .Ride.RestingTime }}
            {{ else }}
            N/A
            {{ end }}
            <small class="label">Resting Time</small>
          </div>
        </section>
        <section class="row">
          <div class="col">
            {{ if .Ride.ElapsedDays }}
            {{ .Ride.ElapsedDays }} days
            {{ else }}
            N/A
            {{ end }}
            <small class="label">Elapsed Days</small>
          </div>
          <div class="col">
            {{ if .Ride.RemainingDays }}
            {{ .Ride.RemainingDays }} days
            {{ else }}
            N/A
            {{ end }}
            <small class="label">Remaining Days</small>
          </div>
        </section>
      </article>
    </section>
  </aside>
  <div class="map-container">
    <div id="mapid" class="map"></div>
  </div>
  <div class="messages-container">
    <h2>Messages</h2>
    <form id="messageForm" class="box" action="/messages" method="post">
      <label hidden for="name">Name:</label>
      <input class="text-box" required type="text" id="name" name="name" placeholder="Your name"><br>
      <label hidden for="message">Message:</label>
      <textarea class="text-box" rows="4" required minlength="2" maxlength="160" type="text" id="message" name="message"
        placeholder="Write a message..."></textarea><br>
      <div class="flex mb-10">
        <div>
          <input type="checkbox" id="sentToGarmin" name="sentToGarmin" value="true">
          <label for="sentToGarmin">Send to my tracker*</label>
        </div>
        <input id="submit-button" disabled class="button" type="submit" value="Send">
      </div>
      <div id="email-input-container" class="hidden">
        <label hidden for="email">Email Address:</label>
        <input class="text-box" type="email" id="email" name="email" placeholder="jonas@vingegaard.dk">
      </div>
      <small class="disclaimer">*I will receive the message immediately on my Garmin Tracker.</small>
    </form>
    <ul id="messagesList">
      {{ range .Messages }}
      <li class="box {{if .FromGarmin}}box--border{{end}}">
        <header class="box__header box__header--baseline">
          <div class="left">
            <h3 class="box__title ft-l">{{ .Name }}{{if not .FromGarmin}} wrote{{end}}</h3>
            <small class="box__subtitle" data-timestamp="{{ .TimeStamp }}"></small>
          </div>
        </header>
        <section>
          <p>{{ .Message }}</p>
        </section>
      </li>
      {{ end }}
    </ul>
  </div>
  <div class="days-container">
    <h2>Days</h2>
    {{ if .Days }}
    <ol>
      {{ range $i, $d := .Days }}
      <li class="list-item">
        <input type="hidden" class="day-date" value="{{ $d.Date }}">
        <div class="box">
          <header class="box__header">
            <div class="left">
              <h3 class="box__title">{{ addOne $i }}</h3>
              <small class="box__subtitle">{{ onDayFromString $d.Date }}</small>
            </div>
            <div class="right">
              <small id="kudos-count-{{ $d.Date }}" class="box__subtitle">
                {{ if $d.KudosCount }}
                <span id="kudos-count-{{ $d.Date }}-value">{{ $d.KudosCount }}</span> kudos
                {{ else }}
                Be the first to give kudos
                {{ end }}
              </small>
              <button id="kudos-button-{{ $d.Date }}" class="kudos-button" onclick="sendKudos('{{ $d.Date }}')">
                <svg class="kudos-symbol" xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="-5.0 -10.0 110.0 135.0">
                  <path
                    d="m89.547 43.18c0-1.2461-0.49609-2.4023-1.3945-3.25-0.89062-0.83984-2.1016-1.2812-3.3281-1.2148l-19.508 1.0938c1.043-4.7188 1.8516-10.941 1.4727-20.371-0.34375-8.6172-7.3672-15.367-15.992-15.367h-0.87109c-1.2695 0-2.4805 0.53906-3.3242 1.4766-0.80078 0.88672-1.207 2.0625-1.1406 3.2539-0.63672 11.883-1.1406 14.949-1.5078 17.188-0.17969 1.0977-0.33984 2.0703-0.46094 3.7305-3.1914 2.25-5.0859 5.1797-6.7734 7.793-2.2383 3.4648-4.2227 6.5234-8.9062 8.0078-0.082031-1.9062-1.6523-3.4297-3.5781-3.4297h-10.199c-1.9766 0-3.582 1.6094-3.582 3.582v46.668c0 1.9766 1.6094 3.582 3.582 3.582h10.199c1.7344 0 3.1875-1.2422 3.5117-2.8789 6.7109 2.2734 13.961 2.8359 21.031 2.8359 3.5898 0 7.1367-0.14453 10.543-0.28516 3.2695-0.13281 6.3594-0.25781 9.3398-0.26562l7.832 0.44141c1.0664 0.058594 2.125-0.32812 2.8984-1.0586 0.77344-0.73047 1.2148-1.7617 1.2148-2.832v-6.7773l0.16406 0.007813 0.0625 0.003906c1.1562 0.066407 2.3008-0.35156 3.1406-1.1445 0.84766-0.80078 1.3164-1.8906 1.3164-3.0664v-8.6445c1.0312-0.10547 2.0156-0.55078 2.7734-1.2695 0.95312-0.90234 1.4766-2.125 1.4766-3.4453v-9.707c0-0.84766-0.22656-1.6719-0.64062-2.3945 0.41797-0.68359 0.64062-1.4766 0.64062-2.3086v-9.9648zm-66.227 48.246h-8.3633v-44.832h8.3633zm52.793-0.18359-7.2578-0.40625c-0.042969-0.003907-0.089844-0.007813-0.12891-0.003907-3.0898 0.003907-6.2461 0.13281-9.5859 0.26562-10.688 0.4375-21.723 0.88281-31.324-2.8125v-38.098c7.1992-1.7617 10.102-6.2383 12.68-10.23 1.75-2.707 3.4023-5.2656 6.3359-7.0469 0.63672-0.38672 1.0391-1.0625 1.0781-1.8047 0.11328-2.1562 0.26562-3.0898 0.48047-4.3828 0.38672-2.3516 0.91797-5.5742 1.5703-17.824 0.007812-0.10547 0.003906-0.21484-0.007813-0.32031h0.83594c6.1953 0 11.246 4.8516 11.492 11.043 0.4375 10.938-0.73438 17.051-2.0625 22.027-0.1875 0.69531-0.027344 1.4414 0.42969 2.0039 0.45703 0.55859 1.1523 0.86719 1.8711 0.82812l22.512-1.2617v9.8906c-0.007812 0-0.011719 0.003906-0.019531 0.003906h-0.042969l-19.906-1.1172c-1.2422-0.074219-2.3047 0.87891-2.375 2.1211-0.070312 1.2422 0.87891 2.3047 2.1211 2.375l19.688 1.1055c0.0625 0.007813 0.125 0.015625 0.1875 0.019532 0.078125 0.003906 0.15625 0.007812 0.23047 0.007812 0.035157 0.023438 0.11719 0.09375 0.11719 0.23047v9.707c0 0.046875-0.007812 0.11719-0.070312 0.17188-0.035157 0.03125-0.09375 0.070313-0.17969 0.0625l-3.2539-0.18359-19.141-1.0742c-1.25-0.070312-2.3047 0.87891-2.375 2.1211-0.070313 1.2422 0.87891 2.3047 2.1211 2.375l18.648 1.0469v8.5352l-17.422-0.97656c-1.2422-0.070313-2.3047 0.87891-2.375 2.1211-0.070313 1.2422 0.87891 2.3047 2.1211 2.375l12.992 0.73047v6.3828z" />
                </svg>
              </button>
            </div>
          </header>
          <section class="row row-flex">
            <div class="box_metric">{{ oneDecimal (inKm $d.DistanceInMeters) }} km<small class="label">Distance</small>
            </div>
            <div class="box_metric">{{ oneDecimal $d.AverageSpeed }} km/h<small class="label">Speed</small></div>
            <div class="box_metric">{{ $d.ElevationGain }} m<small class="label">Elevation Gain</small></div>
            <div class="box_metric">{{ oneDecimal $d.AverageAltitude }} m<small class="label">Average Altitude</small>
            </div>
            <div class="box_metric">{{ time $d.MovingTimeInSeconds }}<small class="label">Time</small></div>
          </section>
        </div>
        <div class="photos"></div>
      </li>
      {{ end }}
    </ol>
    {{ else }}
    We haven't biked yet ...
    {{ end }}
  </div>
</div>

{{end}}
